<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-UK" xml:lang="en-UK" >

<head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />     <meta name="author" content="Fidel Oltra, Ricardo Sánchez" />        <title>Unit 14b. Javascript review</title>
    <style>
        code{white-space: pre-wrap;}
        span.smallcaps{font-variant: small-caps;}
        div.columns{display: flex; gap: min(4vw, 1.5em);}
        div.column{flex: auto; overflow-x: auto;}
        div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
        /* The extra [class] is a hack that increases specificity enough to
           override a similar rule in reveal.js */
        ul.task-list[class]{list-style: none;}
        ul.task-list li input[type="checkbox"] {
          font-size: inherit;
          width: 0.8em;
          margin: 0 0.8em 0.2em -1.6em;
          vertical-align: middle;
        }
        .display.math{display: block; text-align: center; margin: 0.5rem auto;}
        /* CSS for syntax highlighting */
        pre > code.sourceCode { white-space: pre; position: relative; }
        pre > code.sourceCode > span { line-height: 1.25; }
        pre > code.sourceCode > span:empty { height: 1.2em; }
        .sourceCode { overflow: visible; }
        code.sourceCode > span { color: inherit; text-decoration: inherit; }
        div.sourceCode { margin: 1em 0; }
        pre.sourceCode { margin: 0; }
        @media screen {
        div.sourceCode { overflow: auto; }
        }
        @media print {
        pre > code.sourceCode { white-space: pre-wrap; }
        pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
        }
        pre.numberSource code
          { counter-reset: source-line 0; }
        pre.numberSource code > span
          { position: relative; left: -4em; counter-increment: source-line; }
        pre.numberSource code > span > a:first-child::before
          { content: counter(source-line);
            position: relative; left: -1em; text-align: right; vertical-align: baseline;
            border: none; display: inline-block;
            -webkit-touch-callout: none; -webkit-user-select: none;
            -khtml-user-select: none; -moz-user-select: none;
            -ms-user-select: none; user-select: none;
            padding: 0 4px; width: 4em;
            color: #aaaaaa;
          }
        pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
        div.sourceCode
          {  background-color: #f8f8f8; }
        @media screen {
        pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
        }
        code span.al { color: #ef2929; } /* Alert */
        code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
        code span.at { color: #204a87; } /* Attribute */
        code span.bn { color: #0000cf; } /* BaseN */
        code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
        code span.ch { color: #4e9a06; } /* Char */
        code span.cn { color: #8f5902; } /* Constant */
        code span.co { color: #8f5902; font-style: italic; } /* Comment */
        code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
        code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
        code span.dt { color: #204a87; } /* DataType */
        code span.dv { color: #0000cf; } /* DecVal */
        code span.er { color: #a40000; font-weight: bold; } /* Error */
        code span.ex { } /* Extension */
        code span.fl { color: #0000cf; } /* Float */
        code span.fu { color: #204a87; font-weight: bold; } /* Function */
        code span.im { } /* Import */
        code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
        code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
        code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
        code span.ot { color: #8f5902; } /* Other */
        code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
        code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
        code span.ss { color: #4e9a06; } /* SpecialString */
        code span.st { color: #4e9a06; } /* String */
        code span.va { color: #000000; } /* Variable */
        code span.vs { color: #4e9a06; } /* VerbatimString */
        code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
        <link rel="stylesheet" href="../web_template/aqua.css" />  
    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
    <![endif]-->
      
</head>

<body>
    <div id="content">
                 <header id="title-block-header">
            <h1 class="title">Unit 14b. Javascript review</h1>
            <!---->
            <!--         <p class="author">Fidel Oltra, Ricardo
Sánchez</p>
         -->
                    </header>
                 <nav id="TOC" role="doc-toc">
            <div class="navContainer">
                                <h2 id="toc-title">Index</h2>
                 <ul>
<li><a href="#javascript-review" id="toc-javascript-review"><span
class="toc-section-number">1</span> Javascript review</a>
<ul>
<li><a href="#functions-and-arrow-functions"
id="toc-functions-and-arrow-functions"><span
class="toc-section-number">1.1</span> Functions and arrow functions</a>
<ul>
<li><a href="#traditional-functions"
id="toc-traditional-functions"><span
class="toc-section-number">1.1.1</span> Traditional functions</a></li>
<li><a href="#anonymous-functions" id="toc-anonymous-functions"><span
class="toc-section-number">1.1.2</span> Anonymous Functions</a></li>
<li><a href="#arrow-functions" id="toc-arrow-functions"><span
class="toc-section-number">1.1.3</span> Arrow Functions</a></li>
<li><a href="#direct-use-of-arrow-functions"
id="toc-direct-use-of-arrow-functions"><span
class="toc-section-number">1.1.4</span> Direct Use of Arrow
Functions</a></li>
</ul></li>
<li><a href="#callbacks" id="toc-callbacks"><span
class="toc-section-number">1.2</span> Callbacks</a></li>
<li><a href="#promises" id="toc-promises"><span
class="toc-section-number">1.3</span> Promises</a>
<ul>
<li><a href="#creating-a-promise.-elements-to-consider"
id="toc-creating-a-promise.-elements-to-consider"><span
class="toc-section-number">1.3.1</span> Creating a Promise. Elements to
Consider</a></li>
<li><a href="#consuming-promises" id="toc-consuming-promises"><span
class="toc-section-number">1.3.2</span> Consuming Promises</a></li>
<li><a href="#the-asyncawait-specification"
id="toc-the-asyncawait-specification"><span
class="toc-section-number">1.3.3</span> The async/await
Specification</a></li>
</ul></li>
</ul></li>
</ul>
            </div>
        </nav>
                <main>
            <h1 data-number="1" id="javascript-review"><span
            class="header-section-number">1</span> Javascript
            review</h1>
            <p>To successfully complete this part of the course, the
            student must already have prior knowledge of Javascript,
            especially regarding arrow functions, callbacks and
            promises. These notes serve as a reminder or review of these
            concepts.</p>
            <h2 data-number="1.1"
            id="functions-and-arrow-functions"><span
            class="header-section-number">1.1</span> Functions and arrow
            functions</h2>
            <p>Let’s now see the different ways of defining functions in
            JavaScript. We will introduce a concept that has become very
            common, and that we will use very often. It is an
            alternative notation to define methods or functions, the
            so-called <strong>arrow</strong> or <strong>lambda</strong>
            functions.</p>
            <h3 data-number="1.1.1" id="traditional-functions"><span
            class="header-section-number">1.1.1</span> Traditional
            functions</h3>
            <p>Let’s see a traditional function with its use:</p>
            <div class="sourceCode" id="cb1"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">add</span>(num1<span class="op">,</span> num2) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num1 <span class="op">+</span> num2<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Using the function</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="fu">add</span>(<span class="dv">3</span><span class="op">,</span> <span class="dv">2</span>))<span class="op">;</span> <span class="co">// Displays 5</span></span></code></pre></div>
            <h3 data-number="1.1.2" id="anonymous-functions"><span
            class="header-section-number">1.1.2</span> Anonymous
            Functions</h3>
            <p>This same function can also be expressed as an
            <strong>anonymous function</strong>. These functions are
            declared “on the fly” and are usually assigned to a variable
            for later naming or calling:</p>
            <div class="sourceCode" id="cb2"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> addAnonymous <span class="op">=</span> <span class="kw">function</span>(num1<span class="op">,</span> num2) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num1 <span class="op">+</span> num2<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="fu">addAnonymous</span>(<span class="dv">3</span><span class="op">,</span> <span class="dv">2</span>))<span class="op">;</span></span></code></pre></div>
            <h3 data-number="1.1.3" id="arrow-functions"><span
            class="header-section-number">1.1.3</span> Arrow
            Functions</h3>
            <p><strong>Arrow functions</strong> provide a way to define
            functions using a <em>lambda expression</em> to specify
            parameters in parentheses and the function code in curly
            braces, separated by an arrow. The <code>function</code>
            keyword is omitted when defining them.</p>
            <p>The previous function, expressed as an arrow function,
            would look like this:</p>
            <div class="sourceCode" id="cb3"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> add <span class="op">=</span> (num1<span class="op">,</span> num2) <span class="kw">=&gt;</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num1 <span class="op">+</span> num2<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
            <p>Similar to anonymous functions, their value can be
            assigned to a variable for later use or defined on the spot
            in a specific code snippet.</p>
            <p>In fact, the above code can be further simplified: in
            cases where the function simply returns a value, the curly
            braces and the ‘return’ keyword can be omitted:</p>
            <div class="sourceCode" id="cb4"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> add <span class="op">=</span> (num1<span class="op">,</span> num2) <span class="kw">=&gt;</span> num1 <span class="op">+</span> num2<span class="op">;</span></span></code></pre></div>
            <p>Additionally, if the function has a single parameter, the
            parentheses can be omitted. For example, the following
            function returns twice the number it receives as a
            parameter:</p>
            <div class="sourceCode" id="cb5"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> double <span class="op">=</span> num <span class="kw">=&gt;</span> <span class="dv">2</span> <span class="op">*</span> num<span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="fu">double</span>(<span class="dv">3</span>))<span class="op">;</span> <span class="co">// Displays 6</span></span></code></pre></div>
            <h3 data-number="1.1.4"
            id="direct-use-of-arrow-functions"><span
            class="header-section-number">1.1.4</span> Direct Use of
            Arrow Functions</h3>
            <p>As mentioned before, arrow functions, like anonymous
            functions, have the advantage of being used directly where
            they are needed. For example, given the following list of
            personal data:</p>
            <div class="sourceCode" id="cb6"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> data <span class="op">=</span> [</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">&quot;John&quot;</span><span class="op">,</span> <span class="dt">phone</span><span class="op">:</span> <span class="st">&quot;966343434&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">40</span>}<span class="op">,</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Anne&quot;</span><span class="op">,</span> <span class="dt">phone</span><span class="op">:</span> <span class="st">&quot;9112565656&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">55</span>}<span class="op">,</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Marcus&quot;</span><span class="op">,</span> <span class="dt">phone</span><span class="op">:</span> <span class="st">&quot;612998877&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">13</span>}<span class="op">,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Mary&quot;</span><span class="op">,</span> <span class="dt">phone</span><span class="op">:</span> <span class="st">&quot;611664366&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">17</span>}</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>]<span class="op">;</span></span></code></pre></div>
            <p>If we want to filter people who are of legal age, we can
            do it with an anonymous function combined with the ‘filter’
            function:</p>
            <div class="sourceCode" id="cb7"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> adults <span class="op">=</span> data<span class="op">.</span><span class="fu">filter</span>(<span class="kw">function</span>(person) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> person<span class="op">.</span><span class="at">age</span> <span class="op">&gt;=</span> <span class="dv">18</span><span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(adults)<span class="op">;</span></span></code></pre></div>
            <p>We can also use an arrow function instead:</p>
            <div class="sourceCode" id="cb8"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> adults <span class="op">=</span> data<span class="op">.</span><span class="fu">filter</span>(person <span class="kw">=&gt;</span> person<span class="op">.</span><span class="at">age</span> <span class="op">&gt;=</span> <span class="dv">18</span>)<span class="op">;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(adults)<span class="op">;</span></span></code></pre></div>
            <p>Note that we don’t assign the function to a variable for
            later use; instead, they are used at the same point where
            they are defined. The code becomes more concise using an
            arrow function.</p>
            <p>The difference between arrow functions and traditional
            notation or anonymous functions is that with arrow
            functions, we cannot access the <code>this</code> or
            <code>arguments</code> elements, which are available in
            anonymous or traditional functions. Therefore, if it is
            necessary to do so, we should opt for a normal or anonymous
            function in such cases.</p>
            <h2 data-number="1.2" id="callbacks"><span
            class="header-section-number">1.2</span> Callbacks</h2>
            <p>One of the two pillars on which asynchronous programming
            in JavaScript is based is callbacks. A
            <strong>callback</strong> is a function, A, passed as a
            parameter to another function, B, which will be called at
            some point during the execution of B (usually when B
            completes its task). This concept is fundamental for giving
            Node.js and JavaScript asynchronous behavior: a function is
            called, and it is instructed on what to do when it finishes,
            allowing the program to focus on other tasks in the
            meantime.</p>
            <p>An example is the <code>setTimeout</code> function in
            JavaScript. This function can be given a function to call
            and a time (in milliseconds) to wait before calling it.
            After executing the <code>setTimeout</code> line, the
            program continues, and when the time expires, the specified
            callback function is called.</p>
            <p>Let’s write this example in a file called
            ‘callback.js’:</p>
            <div class="sourceCode" id="cb9"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="pp">setTimeout</span>(<span class="kw">function</span>() {<span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Callback finished&quot;</span>)<span class="op">;</span>}<span class="op">,</span> <span class="dv">2000</span>)<span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Hello&quot;</span>)<span class="op">;</span></span></code></pre></div>
            <p>If we run the example, we will see that the first message
            displayed is “Hello” and, after two seconds, the “Callback
            finished” message appears. That is, we called
            <code>setTimeout</code>, the program continued, wrote
            “Hello” on the screen, and once the specified time had
            passed, the callback was called to do its job.</p>
            <p>We will extensively use callbacks throughout this course,
            especially to process the result of some promises that we
            will use or the handling of some service requests.</p>
            <h2 data-number="1.3" id="promises"><span
            class="header-section-number">1.3</span> Promises</h2>
            <p><strong>Promises</strong> are another important mechanism
            for introducing asynchronous behavior into JavaScript. They
            are used to define the completion (successful or not) of an
            asynchronous operation. In our code, we can define promises
            to perform asynchronous operations or (more commonly) use
            promises defined by others in the use of their
            libraries.</p>
            <p>Throughout this course, we will use promises to, for
            example, send operations to a database and collect the
            results when they finish, without blocking the main program.
            However, to better understand what we will do, it is useful
            to have a clear understanding of the structure of a promise
            and the possible responses it offers.</p>
            <h3 data-number="1.3.1"
            id="creating-a-promise.-elements-to-consider"><span
            class="header-section-number">1.3.1</span> Creating a
            Promise. Elements to Consider</h3>
            <p>In the case that we want to create a promise, we will
            create an object of type <code>Promise</code>. To this
            object is passed a function with two parameters:</p>
            <ul>
            <li>The <em>callback</em> function to call if everything
            goes well.</li>
            <li>The <em>callback</em> function to call if there has been
            any error.</li>
            </ul>
            <p>These two parameters are usually called ‘resolve’ and
            ‘reject,’ respectively. So, a basic promise skeleton, using
            an arrow function to define the function to execute, would
            be:</p>
            <div class="sourceCode" id="cb10"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> variableName <span class="op">=</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Code to execute</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// If everything is OK, call &quot;resolve&quot;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// If something fails, call &quot;reject&quot;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
            <p>Internally, the function will do its job and call its two
            parameters in any case. In the case of <code>resolve</code>,
            the result of the operation is usually passed as a
            parameter, and in the case of <code>reject</code>, the
            produced error is usually passed.</p>
            <p>Let’s see an example. The following promise looks for
            adults in the list of people seen in a previous example. If
            results are found, they are returned with the ‘resolve’
            function. Otherwise, an error is generated and sent with
            ‘reject’:</p>
            <div class="sourceCode" id="cb11"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> data <span class="op">=</span> [</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">&quot;John&quot;</span><span class="op">,</span> <span class="dt">phone</span><span class="op">:</span> <span class="st">&quot;966343434&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">40</span>}<span class="op">,</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Anne&quot;</span><span class="op">,</span> <span class="dt">phone</span><span class="op">:</span> <span class="st">&quot;9112565656&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">55</span>}<span class="op">,</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Marcus&quot;</span><span class="op">,</span> <span class="dt">phone</span><span class="op">:</span> <span class="st">&quot;612998877&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">13</span>}<span class="op">,</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Mary&quot;</span><span class="op">,</span> <span class="dt">phone</span><span class="op">:</span> <span class="st">&quot;611664366&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">17</span>}</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>]<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> adultsPromise <span class="op">=</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> {</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> result <span class="op">=</span> data<span class="op">.</span><span class="fu">filter</span>(person <span class="kw">=&gt;</span> person<span class="op">.</span><span class="at">age</span> <span class="op">&gt;=</span> <span class="dv">18</span>)<span class="op">;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (result<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">resolve</span>(result)<span class="op">;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">reject</span>(<span class="st">&quot;No results found&quot;</span>)<span class="op">;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(adultsPromise)<span class="op">;</span></span></code></pre></div>
            <p>The function that defines the promise could also be
            defined in this other way:</p>
            <div class="sourceCode" id="cb12"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> adultsPromise <span class="op">=</span> list <span class="kw">=&gt;</span> {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> result <span class="op">=</span> list<span class="op">.</span><span class="fu">filter</span>(person <span class="kw">=&gt;</span> person<span class="op">.</span><span class="at">age</span> <span class="op">&gt;=</span> <span class="dv">18</span>)<span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (result<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">resolve</span>(result)<span class="op">;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">reject</span>(<span class="st">&quot;No results found&quot;</span>)<span class="op">;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
            <p>This way, we avoid using global variables, and the array
            is passed as a parameter to the function itself, which
            returns the <code>Promise</code> object once it is
            concluded.</p>
            <h3 data-number="1.3.2" id="consuming-promises"><span
            class="header-section-number">1.3.2</span> Consuming
            Promises</h3>
            <p>In the case of wanting to use a previously defined
            promise (or created by others in some library), we simply
            call the function or object that triggers the promise and
            collect the result. In this case:</p>
            <ul>
            <li>To collect a successful result (‘resolve’), we use the
            ‘then’ clause.</li>
            <li>To collect an erroneous result (‘reject’), we use the
            ‘catch’ clause.</li>
            </ul>
            <p>Thus, the previous promise can be used in this way
            (again, using arrow functions to process the ‘then’ clause
            with its result or the ‘catch’ with its error):</p>
            <div class="sourceCode" id="cb13"><pre
            class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adultsPromise</span>(data)<span class="op">.</span><span class="fu">then</span>(result <span class="kw">=&gt;</span> {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// If we enter here, the promise has been processed successfully</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// In &quot;result,&quot; we can access the obtained result</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Matches found:&quot;</span>)<span class="op">;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(result)<span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">catch</span>(error <span class="kw">=&gt;</span> {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// If we enter here, there has been an error processing the promise</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// We can check &quot;error&quot; for details</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Error:&quot;</span><span class="op">,</span> error)<span class="op">;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
            <p>Copy this code below the previous code in the
            ‘promise_test.js’ file created earlier to check the
            functionality and what the promise shows.</p>
            <p>Note that, when defining the promise, the structure of
            the result or the error is also defined. In this case, the
            result is a vector of people matching the search criteria,
            and the error is a text string. However, they can be of any
            data type.</p>
            <h3 data-number="1.3.3"
            id="the-asyncawait-specification"><span
            class="header-section-number">1.3.3</span> The async/await
            Specification</h3>
            <p>Since ECMAScript 7, a new way of working with promises is
            available through the async/await specification. It is a
            more convenient way to call asynchronous functions and
            collect their result before calling another, without the
            need to nest ‘then’ clauses to link the result of one
            promise with the next.</p>
            <p>We will not go into details on how to use it for now. We
            will do so later, when we are familiar with promises.</p>
        </main>
        

        <!--- Modal images -->

        <!-- The Modal -->
        <div id="myModal" class="modal">

            <!-- The Close Button -->
            <!--span class="close">&times;</span-->

            <!-- Modal Content (The Image) -->
            <img class="modal-content" id="img01">

            <!-- Modal Caption (Image Text) -->
            <div id="caption"></div>
        </div>

        <!-- End Modal Images -->

        <!-- Snackbar for copy code -->
        <div id="snackbar">Codi copiat!</div>
        <!-- End Snackbar -->

        <script>
            function ModalizeImages() {
                // Script basat en https://www.w3schools.com/howto/howto_css_modal_images.asp
                // PEr ampliar imatges en fer click

                // Get the modal
                var modal = document.getElementById("myModal");

                var modalImg = document.getElementById("img01");
                var captionText = document.getElementById("caption");

                // Get the image and insert it inside the modal - use its "alt" text as a caption
                //var img = document.getElementById("myImg");
                document.querySelectorAll("img").forEach((img => {
                        img.onclick = function() {
                            modal.style.display = "block";
                            modalImg.src = this.src;
                            captionText.innerHTML = this.alt;
                        }
                    }))
                    // Get the <span> element that closes the modal
                var span = document.getElementsByClassName("close")[0];

                // When the user clicks on <span> (x), close the modal
                //span.onclick = function() {
                myModal.onclick = function() {
                    modal.style.display = "none";
                }


            }


            function markItem(id) {
                // Restaurem format de tots
                document.querySelectorAll("#TOC a").forEach(function(item) {
                        //item.style.fontWeight = "300";
                        item.classList.remove("navItemSelected");
                    })
                    //item.style.color = "#ff0000";

                // Afegim format
                let items = document.querySelectorAll("#TOC a[href='#" + id + "']");
                items.forEach(function(item) {
                    //item.style.fontWeight = "bolder";
                    item.classList.add("navItemSelected");
                })

            }

            var observer = new IntersectionObserver(function(entries) {
                // isIntersecting is true when element and viewport are overlapping
                // isIntersecting is false when element and viewport don't overlap
                if (entries[0].isIntersecting === true) {
                    let id = entries[0].target.id;
                    markItem(id);
                }

            }, {
                threshold: [0]
            });

            window.addEventListener("load", function() {
                document.querySelectorAll("h1, h2, h3").forEach(function(item) {
                    observer.observe(item);
                });

                document.querySelectorAll("#TOC a").forEach(function(item) {
                    item.addEventListener("click", function(item) {
                        markItem(item.id);
                    })
                })

                // Fem modals totes les imatges
                ModalizeImages();
            })

            document.querySelector("#TOC").addEventListener("click", function(event) {
                let toc = event.target
                if (toc.offsetWidth > 10) {
                    toc.classList.add("minimizedToc");
                }
            })

            document.querySelector("#TOC").addEventListener("mouseover", function(event) {
                let toc = event.target
                if (toc.classList.contains("minimizedToc"))
                    toc.classList.remove("minimizedToc");
            })


                        
            /* PER COPIAR CODI */


            // Busca tots els elements amb la classe "sourceCode"
            var sourceCodeElements = document.querySelectorAll('div.sourceCode');

            /*Afegim el botó a tots els divs */
            // Afegir un botó per a cada element "sourceCode"
            sourceCodeElements.forEach(function(element) {
                console.log(element.id);
                var button = document.createElement('div');
                button.className = 'button-copy';

                // Afegir una icona al botó (fa servir FontAwesome com a exemple)
                //var icon = document.createElement('i');
                //icon.className = 'fas fa-copy'; // Utilitza l'ícona "copy" de FontAwesome

                // Obté l'ID de l'element actual
                var elementId = element.id;

                // Afegeix un event listener al botó per cridar la funció amb l'ID
                button.addEventListener('click', function() {
                    copyContent(elementId);
                });

                // Afegeix l'icona al botó i el botó just dins de l'element "sourceCode"
                //button.appendChild(icon);
                element.appendChild(button);
            });



            // Funció per copiar el contingut d'un element amb l'ID donat
            function copyContent(elementId) {
                var element = document.getElementById(elementId);
                var textToCopy = element.innerText;

                // Crea un element de text i copia el contingut
                var textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);

                // Selecciona i copia el text
                textArea.select();
                document.execCommand('copy');

                // Elimina l'element de text afegit temporalment
                document.body.removeChild(textArea);

                // Notifica a l'usuari que el codi s'ha copiat
                mostraSnackbar();
            }

            /* SNACKBAR EN COPIAR CODI */

            function mostraSnackbar() {
            // Busquem l'snackbar
            var x = document.getElementById("snackbar");

            // Li afegim la classe show
            x.className = "show";

            // I als tres segons la llevem
            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
            } 




        </script>
    </div>
</body>

</html>